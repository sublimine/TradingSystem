# Calibrated Configurations - MANDATO 22

This directory contains calibrated strategy configurations generated by the institutional calibration pipeline.

## Directory Structure

```
config/calibrated/
├── README.md                          # This file
├── active/                            # Active (promoted) configs
│   ├── ACTIVE_STRATEGIES_INDEX.yaml  # Index of active strategies
│   ├── strategy_*_active.yaml        # Active strategy configs
│   └── brain_policies_active.yaml    # Active brain policies
│
└── *.yaml                            # Calibrated configs (pre-promotion)
```

## Workflow

### 1. Calibration Pipeline Execution

```bash
python scripts/run_full_calibration_pipeline.py
```

This generates calibrated configs in `config/calibrated/`.

### 2. Promotion to Active

After hold-out validation, configs marked as **ADOPT** or **PILOT** are promoted to `active/`.

Promotion criteria:
- Hold-out Sharpe > 1.0
- Hold-out Calmar > 1.0
- Hold-out Win Rate > 55%
- NO catastrophic drawdown in hold-out

### 3. Using Active Configs

**Manual activation** (NOT automatic):

Edit `config/runtime_profile_paper.yaml` or `config/system_config.yaml`:

```yaml
# Option 1: Use calibrated configs
use_calibrated_configs: true
calibrated_config_dir: "config/calibrated/active"

# Option 2: Specify individual configs
strategies:
  liquidity_sweep:
    config_file: "config/calibrated/active/strategy_liquidity_sweep_active.yaml"
```

**IMPORTANT**: Calibrated configs are NOT auto-activated. Operator must explicitly enable them.

## Active Configs Index

`active/ACTIVE_STRATEGIES_INDEX.yaml` contains:
- Last calibration date
- Pipeline version
- Data period used
- List of active configs
- Number of active strategies

Example:

```yaml
last_calibration_date: '2025-11-14T23:00:00'
pipeline_version: '1.0-MANDATO22'
data_period:
  start: '2023-01-01'
  end: '2024-06-30'
active_configs:
  - strategy_liquidity_sweep_active.yaml
  - strategy_vpin_reversal_extreme_active.yaml
  - brain_policies_active.yaml
num_active_strategies: 2
```

## Naming Convention

**Pre-promotion** (in `config/calibrated/`):
- `strategy_{name}_calibrated.yaml` - Calibrated strategy
- `brain_policies_calibrated.yaml` - Calibrated brain

**Post-promotion** (in `config/calibrated/active/`):
- `strategy_{name}_active.yaml` - Active strategy
- `brain_policies_active.yaml` - Active brain

## Calibration Reports

See `docs/MANDATO22_CALIBRACION_REAL_*.md` for:
- Calibration period
- Symbols used
- Metrics BEFORE vs AFTER
- Hold-out validation results
- Promotion decisions

## Version Control

**DO commit**:
- `active/ACTIVE_STRATEGIES_INDEX.yaml`
- Active configs (*.yaml)
- Calibration reports (docs/)

**DO NOT commit**:
- Large data files
- Temporary backtest outputs

## Rollback

To revert to previous calibration:

```bash
# 1. Backup current active
mv config/calibrated/active config/calibrated/active_backup_$(date +%Y%m%d)

# 2. Restore from version control
git checkout HEAD~1 -- config/calibrated/active/

# 3. Or use specific commit
git checkout <commit-hash> -- config/calibrated/active/
```

## Safety

**NON-NEGOTIABLES**:
- ✅ Risk limits 0-2% are NOT modified by calibration
- ✅ Calibration adjusts ONLY strategy parameters
- ✅ RiskAllocator logic is UNTOUCHED
- ✅ Circuit breakers remain active

**Calibrated parameters**:
- Entry thresholds
- Exit thresholds
- Signal quality filters
- Microstructure parameters
- Timeframe weights (brain-layer)

**NOT calibrated** (institutional constants):
- Risk per trade (0-2%)
- Max portfolio risk (6%)
- Max correlation (0.7)
- Circuit breaker thresholds

---

**MANDATO**: 22 - Orquestación Calibración Real
**Author**: SUBLIMINE Institutional Trading System
**Date**: 2025-11-14
